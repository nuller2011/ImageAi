<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vimage Online</title>
    <style>
        textarea {
            width: 80%;
            max-width: 600px;
            height: 100px;
            margin-bottom: 20px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 16px;
        }
        #progressBar {
            width: 80%;
            margin-top: 20px;
            display: none;
            margin-left: 10%;
            margin-right: 10%;
        }
        #resultImage {
            margin-left: auto;
            margin-right: auto;
            display: none;
            max-width: 50%;
        }
    </style>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<body style="text-align: center;" class="bg-dark align-items-center">
    <h1 style="color: white; margin-top: 2%;">Vimage</h1>
    <textarea id="inputText" placeholder="Введите описание..."></textarea><br>
    <button id="submitButton" class="btn btn-light" style="margin-top: 2%;">Создать изображение</button>
    <h2 style="color: white; margin-top: 2%;">Результат:</h2>
    <img id="resultImage" alt="Результат"/>

    <script>
        const botToken = "7629798081:AAF00xTeYAhJvSSTng3It0SFcxLZL9lyiRU";
        const cryptoBotApi = "288965:AAr1Izu5FdXtsnrBVYFQpRbD1vfkDhLehTV";
        
        async function sendPayment() {
            const response = await fetch(`https://api.telegram.org/bot${cryptoBotApi}/sendMessage`, {
                method: 'POST',
                body: JSON.stringify({ text: "Оплата за создание изображения: 1₽" }),
                headers: { 'Content-Type': 'application/json' }
            });
            return response.json();
        }

        async function queryImage(data) {
            const response = await fetch("https://api-inference.huggingface.co/models/black-forest-labs/FLUX.1-dev", {
                headers: {
                    Authorization: "Bearer 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",
                    "Content-Type": "application/json",
                },
                method: "POST",
                body: JSON.stringify(data),
            });
            return response.blob();
        }

        document.getElementById('submitButton').addEventListener('click', async () => {
            const inputText = document.getElementById('inputText').value;
            const submitButton = document.getElementById('submitButton');
            submitButton.disabled = true;

            await sendPayment(); // Оплата

            const imageData = { prompt: inputText }; // Ваши параметры для генерации изображения
            const imageBlob = await queryImage(imageData);
            const resultImage = document.getElementById('resultImage');
            resultImage.src = URL.createObjectURL(imageBlob);
            resultImage.style.display = 'block';
            submitButton.disabled = false;
        });
    </script>
</body>
</html>
